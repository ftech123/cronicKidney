<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif;}
body, html {
  height: 100%;
  color: #000000;
  background-color: azure;
  line-height: 1.8;
}

/* Navbar */
.w3-top {
  position: sticky;
  top: 0;
}

.w3-bar-item {
  padding: 8px 16px;
}

/* Container */
.container {
  margin-top: 5%;
}

/* Modal Dialog */
.modal-dialog {
  max-width: 90%;
}

/* Table */
.table th,
.table td {
  white-space: nowrap;
}

/* Buttons */
.btn {
  padding: 10px 20px;
}

/* Turn off parallax scrolling for tablets and phones */
@media only screen and (max-device-width: 1600px) {
  .bgimg-1, .bgimg-2, .bgimg-3 {
    background-attachment: scroll;
    min-height: 400px;
  }
}

/* Additional styles for smaller screens */
/* Additional styles for smaller screens */
@media (max-width: 768px) {
    .table th,
    .table td {
        font-size: 14px; /* Adjust font size for better readability */
    }

    .table th.d-none,
    .table td.d-none {
        display: none; /* Hide certain columns on smaller screens */
    }
}

</style>
</head>
<body>

<!-- Navbar (sit on top) -->
<div class="w3-top">
    <div class="w3-bar" id="myNavbar">
        <a href="cronic.html" class="w3-bar-item w3-button "> Detect</a>
        <a href="crud.html" class="w3-bar-item w3-button "> Update Medicine Details</a>
        <a href="alarm.html" class="w3-bar-item w3-button "> Reminder</a>
        <a href="index.html" class="w3-bar-item w3-button "> Logout</a>
      </div>
</div>

<div class="w3-content w3-container w3-padding-64"> 
    <div class="container">

    <section class="p-3">

        <div class="row">
            <div class="col-12">
                <button class="btn btn-primary newUser" data-bs-toggle="modal" data-bs-target="#userForm">New Record <i class="bi bi-people"></i></button>
            </div>
        </div>

        <div class="row">
            <!-- Table -->
            <div class="table-responsive">
                <table class="table table-striped table-hover mt-3 text-center table-bordered">
                    <thead>
                        <tr>
                            <th class="d-none d-md-table-cell">S.No</th>
                            <th class="d-none d-md-table-cell">Doctor Name</th>
                            <th class="d-none d-md-table-cell">Medicine ID</th>
                            <th>Medicine Name</th>
                            <th class="d-none d-md-table-cell">Date Taken</th>
                            <th class="d-none d-md-table-cell">Time Taken</th>
                            <th class="d-none d-md-table-cell">To Be Taken Date</th>
                            <th class="d-none d-md-table-cell">To Be Taken Time</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="data"></tbody>
                </table>
            </div>

        </div>

    </section>

    </div>
</div>

<!--Modal Form-->
<div class="modal fade" id="userForm">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">

            <div class="modal-header">
                <h4 class="modal-title">Fill the Form</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">

                <form action="#" id="myForm">

                    <div class="inputField">
                        <div>
                            <label for="doctorName">Doctor Name:</label>
                            <input type="text" name="" id="doctorName" required>
                        </div>
                        <div>
                            <label for="medId">Medicine ID:</label>
                            <input type="text" name="" id="medId" required>
                        </div>
                        <div>
                            <label for="medName">Medicine Name:</label>
                            <input type="text" name="" id="medName" required>
                        </div>
                        <div>
                            <label for="dateTaken">Date Taken:</label>
                            <input type="date" name="" id="dateTaken" required>
                        </div>
                        <div>
                            <label for="timeTaken">Time Taken:</label>
                            <input type="time" name="" id="timeTaken" required>
                        </div>
                        <div>
                            <label for="toBeTakenDate">To Be Taken Date:</label>
                            <input type="date" name="" id="toBeTakenDate" required>
                        </div>
                        <div>
                            <label for="toBeTakenTime">To Be Taken Time:</label>
                            <input type="time" name="" id="toBeTakenTime" required>
                        </div>
                    </div>

                </form>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" form="myForm" class="btn btn-primary submit">Submit</button>
            </div>
        </div>
    </div>
</div>

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<script>
    var form = document.getElementById("myForm"),
        userInfo = document.getElementById("data"),
        modal = document.getElementById("userForm"),
        modalTitle = document.querySelector("#userForm .modal-title"),
        newUserBtn = document.querySelector(".newUser");

    let getData = localStorage.getItem('userProfile') ? JSON.parse(localStorage.getItem('userProfile')) : [];

    let isEdit = false, editId;

    showInfo();

    newUserBtn.addEventListener('click', ()=> {
        submitBtn.innerText = 'Submit';
        modalTitle.innerText = "Fill the Form";
        isEdit = false;
        form.reset();
    });

    function showInfo(){
        userInfo.innerHTML = ""; // Clear existing data
        getData.forEach((element, index) => {
            let createElement = `<tr class="medicineDetails">
                <td>${index+1}</td>
                <td>${element.doctorName}</td>
                <td>${element.medId}</td>
                <td>${element.medName}</td>
                <td>${element.dateTaken}</td>
                <td>${element.timeTaken}</td>
                <td>${element.toBeTakenDate}</td>
                <td>${element.toBeTakenTime}</td>
                <td>
                    <button class="btn btn-primary" onclick="editInfo(${index}, '${element.doctorName}', '${element.medId}', '${element.medName}', '${element.dateTaken}', '${element.timeTaken}', '${element.toBeTakenDate}', '${element.toBeTakenTime}')" data-bs-toggle="modal" data-bs-target="#userForm">Edit</button>
                    <button class="btn btn-danger" onclick="deleteInfo(${index})">Delete</button>
                </td>
            </tr>`;
            userInfo.innerHTML += createElement;
        });
    }

    function editInfo(index, doctorName, medId, medName, dateTaken, timeTaken, toBeTakenDate, toBeTakenTime){
        isEdit = true;
        editId = index;
        document.getElementById("doctorName").value = doctorName;
        document.getElementById("medId").value = medId;
        document.getElementById("medName").value = medName;
        document.getElementById("dateTaken").value = dateTaken;
        document.getElementById("timeTaken").value = timeTaken;
        document.getElementById("toBeTakenDate").value = toBeTakenDate;
        document.getElementById("toBeTakenTime").value = toBeTakenTime;
        submitBtn.innerText = "Update";
        modalTitle.innerText = "Update The Form";
    }

    function deleteInfo(index){
        if(confirm("Are you sure you want to delete?")){
            getData.splice(index, 1);
            localStorage.setItem("userProfile", JSON.stringify(getData));
            showInfo();
        }
    }

    form.addEventListener('submit', (e)=> {
        e.preventDefault();

        const information = {
            doctorName: document.getElementById("doctorName").value,
            medId: document.getElementById("medId").value,
            medName: document.getElementById("medName").value,
            dateTaken: document.getElementById("dateTaken").value,
            timeTaken: document.getElementById("timeTaken").value,
            toBeTakenDate: document.getElementById("toBeTakenDate").value,
            toBeTakenTime: document.getElementById("toBeTakenTime").value
        };

        if(!isEdit){
            getData.push(information);
        }
        else{
            isEdit = false;
            getData[editId] = information;
        }

        localStorage.setItem('userProfile', JSON.stringify(getData));
        showInfo();
        form.reset();
    });
</script>
</body>
</html>
